# Comparison of Vertex Componet Analysis (VCA) and Genetic Algorithm Endmember Extraction (GAEE) algorithms for Endmember Extraction

## Douglas Winston R. S., Gustavo T. Laureano, Celso G. Camilo Jr.

Endmember Extraction is a critical step in hyperspectral image analysis and classification. It is an useful method to decompose a mixed spectrum into a collection of spectra and their corresponding proportions. In this paper, we solve a linear endmember extraction problem as an evolutionary optimization task, maximizing the Simplex Volume in the endmember space. We propose a standard genetic algorithm and a variation with In Vitro Fertilization module (IVFm) to find the best solutions and compare the results with the state-of-art Vertex Component Analysis (VCA) method and the traditional algorithms Pixel Purity Index (PPI) and N-FINDR. The experimental results on real and synthetic hyperspectral data confirms the overcome in performance and accuracy of the proposed approaches over the mentioned algorithms.

**Envirionment Setup:**

Monte Carlo runs: 2 

Number of endmembers to estimate: 12 

Number of skewers (PPI): 5 

Maximum number of iterations (N-FINDR): 5 

### Parameters used in each GAEE versions

| Parameters            |   GAEE |   GAEE-IVFm |   GAEE-VCA |   GAEE-IVFm-VCA |
|:----------------------|-------:|------------:|-----------:|----------------:|
| Population Size       |   10   |        10   |       10   |            10   |
| Number of Generations |   10   |        10   |       10   |            10   |
| Crossover Probability |    1   |         1   |        1   |             1   |
| Mutation Probability  |    0.3 |         0.3 |        0.3 |             0.3 |

![alt text](Convergence.png)

### Comparison between the ground-truth Laboratory Reflectances and extracted endmembers using PPI, N-FINDR, VCA, GAEE, GAEE-IVFm using SAM for the Cuprite Dataset.

| Endmembers       | PPI                  | NFINDR               | VCA                  | GAEE                 | GAEE-IVFm            | GAEE-VCA            | GAEE-IVFm-VCA       |
|:-----------------|:---------------------|:---------------------|:---------------------|:---------------------|:---------------------|:--------------------|:--------------------|
| Alunite          | 0.37437658746261826  | 0.10336973275005026  | **0.09392418484131637**  | 0.24598137550106125  | 0.25865456851157287  | 0.1042759266381331  | 0.1042759266381331  |
| Andradite        | 0.0757956372797503   | **0.07247090612556395**  | 0.08250147591111771  | 0.08534887606623016  | 0.07927227021138031  | 0.08012512043808485 | 0.07496156838018414 |
| Buddingtonite    | 0.20809001467161906  | 0.07616040898379135  | 0.07859241738205786  | 0.10998783004910366  | 0.11473473909814288  | **0.07615978571645851** | **0.07615978571645851** |
| Dumortierite     | 0.19073382665295066  | **0.07200345126168237**  | 0.0749538089829949   | 0.09161634687855136  | 0.07889033186463985  | 0.07548792897185151 | 0.07548792897185151 |
| Kaolinite_1      | **0.0794623836107879**   | 0.08700558852598048  | 0.08620208931234408  | 0.10230942105959949  | 0.09404436606741502  | 0.08700577984998983 | 0.08700577984998983 |
| Kaolinite_2      | 0.08196337024628163  | 0.08892276352438136  | 0.08762368751456011  | **0.06145413340393229**  | 0.0653337685471969   | 0.07552220774152668 | 0.06420354393621833 |
| Muscovite        | 0.2506332736358707   | **0.1091059603467261**   | 0.13057843067827013  | 0.1372671518427179   | 0.16894647128322476  | 0.10963857896551008 | 0.10963857896551008 |
| Montmonrillonite | 0.13381557810251485  | 0.06480802649167323  | 0.06400351261375818  | **0.059971303107428216** | 0.06011152342955355  | 0.06462712062639014 | 0.07341522008479548 |
| Nontronite       | 0.10329191097253337  | 0.07583864842286078  | 0.11219749109870544  | **0.07492895697333285**  | 0.08330229347068102  | 0.07937473591483905 | 0.08907669480720054 |
| Pyrope           | 0.057882710314811195 | 0.12215775410901439  | 0.23061834166914918  | **0.05591360155700946**  | 0.0742130109110275   | 0.07136437241713506 | 0.06479686093382413 |
| Sphene           | 0.06731084253037734  | 0.2856718576889884   | 0.09553791617337588  | 0.09693772458360793  | **0.05904491086371213**  | 0.1565090598906174  | 0.08532001736749346 |
| Chalcedony       | 0.08712475814966805  | 0.08712475814966805  | **0.07607681846448909**  | 0.13017769863755493  | 0.15021454935102552  | 0.15141447201070754 | 0.09343069930768577 |
| **Statistics**   | PPI                  | NFINDR               | VCA                  | **GAEE**                 | GAEE-IVFm            | GAEE-VCA            | GAEE-IVFm-VCA       |
| _Mean_           | 0.14254007446914863  | 0.10570019340318214  | 0.10198356003926866  | 0.11139118805199173  | 0.11560202566216059  | 0.09546951121055187 | **0.0902168578816262**  |
| _Std_            | **0.0**                  | 0.005332150046550546 | 0.005791564381588326 | 0.009880860373467406 | 0.011600082738123388 | 0.00701747469270556 | 0.00892856661420536 |
| _p-value_        | -44.27347228981887   | -1.7034530102501722  | 0.0                  | **-1.3202245158216084**  | -1.6170569645511255  | 4.36657863277331    | 1.650714939015856   |
| _Time_           | **0.2613123339979211**   | 48.77021998600685    | 0.5846106860044529   | 0.43390920350066153  | 0.44650176000141073  | 0.4206671350111719  | 0.4494677255061106  |

### Comparison between the ground-truth Laboratory Reflectances and extracted endmembers using PPI, N-FINDR, VCA, GAEE, GAEE-IVFm using SID for the Cuprite Dataset.

| Endmembers       | PPI                  | NFINDR                | VCA                   | GAEE                  | GAEE-IVFm             | GAEE-VCA              | GAEE-IVFm-VCA         |
|:-----------------|:---------------------|:----------------------|:----------------------|:----------------------|:----------------------|:----------------------|:----------------------|
| Alunite          | **0.0**                  | **0.0**                   | 0.011289996764965168  | **0.0**                   | **0.0**                   | 0.01450605145043148   | **0.0**                   |
| Andradite        | **0.0**                  | 0.006167885535358127  | 0.009315461989343288  | **0.0**                   | **0.0**                   | 0.008539238428759937  | 0.008737814771371408  |
| Buddingtonite    | 0.047667982208371304 | 0.007190503078861551  | 0.007657065246409068  | 0.015237982484881918  | **0.0**                   | 0.012760187395102863  | 0.007190502060325557  |
| Dumortierite     | 0.056223478489320314 | **0.0068965306261938916** | 0.007544122218419529  | 0.01145735014221726   | 0.009026262397270415  | 0.0077468878720454125 | 0.0077468878720454125 |
| Kaolinite_1      | **0.011366808638633933** | 0.013099138238409556  | 0.012924105346312555  | 0.01725158585529203   | 0.014618531975937772  | 0.013099138300106854  | 0.013099138300106854  |
| Kaolinite_2      | 0.011396307299317761 | 0.01091240218639111   | 0.007250187989638096  | **0.005807188196500822**  | 0.006480900919568723  | 0.005849620838251357  | 0.01445595599842377   |
| Muscovite        | 0.09694699959274558  | 0.030073317564763086  | 0.030750246037813504  | **0.026413310644649267**  | 0.03638173122782495   | 0.03323522887099953   | 0.028533598018130837  |
| Montmonrillonite | 0.022994877759760293 | 0.004877454183616458  | 0.0047468547829238195 | 0.0045839832927729455 | **0.0043921802633248505** | 0.004704323822992157  | 0.006426973542854709  |
| Nontronite       | 0.01263998844876901  | 0.007665487107736893  | 0.013286424686984849  | **0.0075960487096864565** | 0.009132322426009764  | 0.00815810016237877   | 0.011181636692808479  |
| Pyrope           | 0.007134752972457876 | 0.053084582137130285  | 0.06243504631981924   | **0.006287126006490304**  | 0.019924846724447116  | 0.008329530214478395  | 0.008329530214478395  |
| Sphene           | **0.007569050639456094** | 0.09121132246964056   | 0.012169399244837429  | 0.04016220337927792   | 0.056109759872037826  | 0.03724934468706971   | 0.02959666844736003   |
| Chalcedony       | 0.008826757208057166 | 0.008826757208057166  | **0.006907010065589054**  | 0.023473830545445534  | 0.030923268281889932  | 0.010062116598313534  | 0.010062116598313534  |
| **Statistics**   | PPI                  | NFINDR                | VCA                   | **GAEE**                  | GAEE-IVFm             | GAEE-VCA              | GAEE-IVFm-VCA         |
| _Mean_           | 0.02356391693807411  | 0.022101990537315905  | 0.015837258374734386  | **0.014295028981327116**  | 0.018144159064102595  | 0.015625849529636138  | 0.018192224604902843  |
| _Std_            | **0.0**                  | 0.0024464315289225557 | 0.0007485790245613105 | 0.003415741521772061  | 0.006830538217854278  | 0.005382360728369363  | 0.008334459180281958  |
| _p-value_        | -24.586444451071795  | -2.948234286121659    | 0.0                   | 1.341534903063511     | -0.8938425627348      | 0.10761448124908243   | **-0.38688830881995934**  |
| _Time_           | **0.2613123339979211**   | 48.77021998600685     | 0.5846106860044529    | 0.43390920350066153   | 0.44650176000141073   | 0.4206671350111719    | 0.4494677255061106    |

